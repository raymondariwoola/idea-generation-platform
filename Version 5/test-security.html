<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Security Libraries Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .test-section {
            background: white;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        input, textarea {
            width: 100%;
            padding: 10px;
            margin: 10px 0;
            border: 2px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
        }
        .status {
            padding: 10px;
            margin: 10px 0;
            border-radius: 4px;
            font-weight: bold;
        }
        .success {
            background: #d4edda;
            color: #155724;
        }
        .error {
            background: #f8d7da;
            color: #721c24;
        }
        h1 {
            color: #333;
        }
        h2 {
            color: #666;
            margin-top: 0;
        }
    </style>
</head>
<body>
    <h1>üîí Security Libraries Test Page</h1>
    
    <div class="test-section">
        <h2>Initialization Status</h2>
        <div id="pci-status" class="status">‚è≥ Checking PCI DSS Checker...</div>
        <div id="xss-status" class="status">‚è≥ Checking XSS Protection...</div>
    </div>

    <div class="test-section">
        <h2>Test PCI DSS Detection</h2>
        <p><strong></strong>Try these credit card formats:</strong></p>
        <input type="text" id="pci-test1" placeholder="With spaces: 4532 1234 5678 9010" style="margin: 5px 0;">
        <input type="text" id="pci-test2" placeholder="With dashes: 4532-1234-5678-9010" style="margin: 5px 0;">
        <input type="text" id="pci-test3" placeholder="No spaces: 4532123456789010" style="margin: 5px 0;">
        <input type="text" id="pci-test4" placeholder="Try pasting: 4532 1234 5678 9010" style="margin: 5px 0;">
        <p><small>‚úÖ Should auto-redact to: XXXXXXXX (Not PCI DSS Compliant)</small></p>
        <p><small>üí° Try typing AND pasting to test both methods</small></p>
    </div>

    <div class="test-section">
        <h2>Test XSS Protection</h2>
        <p>Try entering a script tag:</p>
        <textarea id="xss-test" rows="3" placeholder="Try: <script>alert('xss')</script>"></textarea>
        <p><small>Should be sanitized on blur</small></p>
    </div>

    <div class="test-section">
        <h2>Console Log</h2>
        <p>Open the browser console (F12) to see detailed logs.</p>
        <div id="console-log" style="background: #000; color: #0f0; padding: 10px; font-family: monospace; max-height: 200px; overflow-y: auto;"></div>
    </div>

    <!-- Load security libraries -->
    <script src="pci-dss-checker.js"></script>
    <script src="xss-protection.js"></script>

    <!-- Test script -->
    <script>
        // Capture console.log
        const originalLog = console.log;
        const consoleLogDiv = document.getElementById('console-log');
        
        console.log = function(...args) {
            originalLog.apply(console, args);
            const message = args.join(' ');
            const line = document.createElement('div');
            line.textContent = `> ${message}`;
            consoleLogDiv.appendChild(line);
            consoleLogDiv.scrollTop = consoleLogDiv.scrollHeight;
        };

        // Wait a moment for scripts to load
        setTimeout(() => {
            console.log('=== Testing Security Libraries ===');
            
            // Check PCI DSS Checker
            const pciStatus = document.getElementById('pci-status');
            if (typeof window.pciChecker !== 'undefined' && window.pciChecker) {
                pciStatus.textContent = '‚úÖ PCI DSS Checker: LOADED';
                pciStatus.className = 'status success';
                console.log('PCI DSS Checker found:', window.pciChecker);
            } else {
                pciStatus.textContent = '‚ùå PCI DSS Checker: NOT LOADED';
                pciStatus.className = 'status error';
                console.log('PCI DSS Checker not found on window');
            }

            // Check XSS Protection
            const xssStatus = document.getElementById('xss-status');
            if (typeof window.xssProtection !== 'undefined' && window.xssProtection) {
                xssStatus.textContent = '‚úÖ XSS Protection: LOADED';
                xssStatus.className = 'status success';
                console.log('XSS Protection found:', window.xssProtection);
            } else {
                xssStatus.textContent = '‚ùå XSS Protection: NOT LOADED';
                xssStatus.className = 'status error';
                console.log('XSS Protection not found on window');
            }

            // Test PCI DSS functionality
            if (window.pciChecker) {
                const testCard = '4532123456789010';
                const sanitized = window.pciChecker.sanitize(testCard);
                console.log('PCI Test - Input:', testCard);
                console.log('PCI Test - Output:', sanitized);
            }

            // Test XSS functionality
            if (window.xssProtection) {
                const testXSS = '<script>alert("xss")</script>Hello';
                const sanitized = window.xssProtection.sanitize(testXSS);
                console.log('XSS Test - Input:', testXSS);
                console.log('XSS Test - Output:', sanitized);
            }

            console.log('=== Test Complete ===');
        }, 500);
    </script>
</body>
</html>
